/*!
 * service.js for ServiceWorkers v1.2
 * Licensed under the MIT license
 * Copyright (c) 2019 Lukas Jans
 * https://github.com/luniverse/service
 */
Service=class{constructor(e){this.config=e,self.addEventListener("install",e=>e.waitUntil(this.install())),self.addEventListener("activate",e=>e.waitUntil(this.activate())),self.addEventListener("fetch",e=>e.respondWith(this.fetch(e)))}async install(){self.skipWaiting(),(await caches.open(this.config.version)).addAll(this.config.cache)}async activate(){await clients.claim();for(const e of await caches.keys())e!=this.config.version&&await caches.delete(e)}async fetch(e){let t={};t.url=new URL(e.request.url),t.GET=t.url.searchParams,t.POST=new URLSearchParams(await e.request.clone().text());const i=await caches.match(e.request);if(i)return i;for(let e of this.config.handlers)if(t.params=e.pattern.exec(t.url.pathname),t.params)try{this.config.requestFilter&&(t=await this.config.requestFilter(t));let i=await e.process(t);return this.config.responseFilter&&(i=await this.config.responseFilter(i)),i}catch(e){return this.config.exceptionHandler?this.config.exceptionHandler(e):Response.error()}return fetch(e.request)}};